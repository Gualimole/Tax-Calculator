
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upgrading to Tax-Calculator 2.0 &#8212; Tax-Calculator</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="Release history" href="releases.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/PSL.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Tax-Calculator</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Tax-Calculator
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Usage
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../usage/starting.html">
   Getting started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../usage/overview.html">
   Structural overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../guide/index.html">
   User guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../recipes/index.html">
   Recipes
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="history.html">
   History
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="roadmap.html">
   Roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="releases.html">
   Release history
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Upgrading to Tax-Calculator 2.0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="license.html">
   License
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Contributing
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing/contributor_guide.html">
   Contributor guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing/pr_workflow.html">
   Pull request workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing/param_naming.html">
   Policy parameter naming and placing conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing/testing.html">
   Testing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../api/public_api.html">
   Tax-Calculator Python API
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/about/upgrading.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PSLmodels/Tax-Calculator"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PSLmodels/Tax-Calculator/issues/new?title=Issue%20on%20page%20%2Fabout/upgrading.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/PSLmodels/Tax-Calculator/edit/master/docs/about/upgrading.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="upgrading-to-tax-calculator-2-0">
<h1>Upgrading to Tax-Calculator 2.0<a class="headerlink" href="#upgrading-to-tax-calculator-2-0" title="Permalink to this headline">¶</a></h1>
<p>Tax-Calculator version 2.0 (and higher) is incompatible with earlier
versions.  The tax logic is unchanged, but 2.0 introduces a simplified
and standardized way of specifying tax reforms (or economic assumption
changes).  This note explains what you have to do in order to use
Tax-Calculator version 2.0 and higher.</p>
<p>What you need to do is change the way you specify tax policy reforms.
Obviously, you need to do this only for reforms you want to analyze
using Tax-Calculator 2.0 and higher.</p>
<p>The details of what to do depend on whether you are in the habit of
specifying reforms in JSON files (as demonstrated in the <a class="reference external" href="https://PSLmodels.github.io/Tax-Calculator/index.html">user
guide</a> and
<a class="reference external" href="https://PSLmodels.github.io/Tax-Calculator/cookbook.html">cookbook</a>)
or whether you take a low-level approach and specify reforms as Python
dictionaries directly in your Python scripts (as done in hundreds of
Tax-Calculator tests).</p>
<p>In both cases you need to do the following:</p>
<ol class="simple">
<li><p>Remove the leading underscore character from each parameter name.</p></li>
<li><p>Remove the brackets around the value of scalar parameters (i.e.,
those that do not vary by filing-unit type, number of EITC-eligible
children, or type of itemized deduction, and therefore, are just a
single value in any year).</p></li>
<li><p>Remove <strong>one</strong> of the double set of brackets around the values of
vector parameters(i.e., those that are not scalar parameters).
This will leave vector parameter values enclosed in just one pair
of brackets.</p></li>
<li><p>Only if you are changing whether a parameter is (wage or price)
indexed for inflation, you need to change the trailing <code class="docutils literal notranslate"><span class="pre">_cpi</span></code>
characters to be <code class="docutils literal notranslate"><span class="pre">-indexed</span></code> (making sure to use a dash and not an
underscore).</p></li>
<li><p>Only if you are changing CPI offset policy, you need to change the
old parameter name <code class="docutils literal notranslate"><span class="pre">_cpi_offset</span></code> to <code class="docutils literal notranslate"><span class="pre">CPI_offset</span></code>.</p></li>
</ol>
<p>That is all that needs to be done to convert JSON reform (or
assumption) files so that they work with Tax-Calculator 2.0 and
higher.  (If you have many JSON reform files that you want to convert,
the first three steps may be able to be automated using the
<code class="docutils literal notranslate"><span class="pre">Tax-Calculator/new_json.py</span></code> script, but be sure to read the short
script before using it.  If your JSON reform files are not formatted
in the way extected by the <code class="docutils literal notranslate"><span class="pre">new_json.py</span></code> script, then make the changes
in the above steps by hand editing each JSON file.)</p>
<p>If you have specified reforms (or changes in economic assumption
parameters) directly in your Python scripts using dictionaries, then
there is another set of changes you need to make to each of those
dictionaries.  In older versions of Tax-Calcualtor, each reform
dictionary was structured using a <code class="docutils literal notranslate"><span class="pre">year</span> <span class="pre">:</span> <span class="pre">param</span> <span class="pre">:</span> <span class="pre">value</span></code> format.
Here is an example of the old format after making the changes
listed above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reform</span> <span class="o">=</span> <span class="p">{</span>
   <span class="mi">2020</span><span class="p">:</span> <span class="p">{</span>
       <span class="s1">&#39;SS_Earnings_c&#39;</span><span class="p">:</span> <span class="mi">200000</span><span class="p">,</span>
   <span class="mi">2021</span><span class="p">:</span> <span class="p">{</span>
       <span class="s1">&#39;SS_Earnings_c&#39;</span><span class="p">:</span> <span class="mi">300000</span><span class="p">,</span>
       <span class="s1">&#39;SS_Earnings_c-indexed&#39;</span><span class="p">:</span> <span class="kc">False</span>
   <span class="p">},</span>
   <span class="mi">2022</span><span class="p">:</span> <span class="p">{</span>
       <span class="s1">&#39;STD&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">14000</span><span class="p">,</span> <span class="mi">28000</span><span class="p">,</span> <span class="mi">14000</span><span class="p">,</span> <span class="mi">21000</span><span class="p">,</span> <span class="mi">28000</span><span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice that the primary keys in the above dictionary are years and the
secondary keys are parameter names.  Beginning with Tax-Calculator
2.0, that order is reversed making the new <code class="docutils literal notranslate"><span class="pre">param</span> <span class="pre">:</span> <span class="pre">year</span> <span class="pre">:</span> <span class="pre">value</span></code>
format consistent with the format of the JSON reform files.</p>
<p>So, the above dictionary needs to be converted (by hand editing) to
the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reform</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">&#39;SS_Earnings_c&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2020</span><span class="p">:</span> <span class="mi">200000</span><span class="p">,</span>
                     <span class="mi">2021</span><span class="p">:</span> <span class="mi">300000</span><span class="p">},</span>
   <span class="s1">&#39;SS_Earnings_c-indexed&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2021</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
   <span class="s1">&#39;STD&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">2022</span><span class="p">:</span> <span class="p">[</span><span class="mi">14000</span><span class="p">,</span> <span class="mi">28000</span><span class="p">,</span> <span class="mi">14000</span><span class="p">,</span> <span class="mi">21000</span><span class="p">,</span> <span class="mi">28000</span><span class="p">]}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you have any problems or questions converting your reforms for
use with Tax-Calculator 2.0, please raise an issue
<a class="reference external" href="https://github.com/PSLmodels/Tax-Calculator/issues">here</a>.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./about"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="releases.html" title="previous page">Release history</a>
    <a class='right-next' id="next-link" href="license.html" title="next page">License</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Policy Simulation Library<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>